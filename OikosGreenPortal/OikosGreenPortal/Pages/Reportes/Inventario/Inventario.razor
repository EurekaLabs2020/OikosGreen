@page "/reporte/inventario"

@inherits InventarioBase
@attribute [Authorize]

<TituloComponent _titulo="Reporte Inventario"></TituloComponent>

<div class="container">
    <div class="row margen-sup">
        <div class="col-md-4">
            <Label>Producto:</Label>
            @if (_listaSecundaria != null)
            {
                <Select TValue="Int64" @bind-SelectedValue="@_datoPadre">
                    <SelectItem TValue="Int64" Value="0">SELECCIONAR...</SelectItem>
                    @foreach (var item in _listaSecundaria)
                    {
                        <SelectItem TValue="Int64" Value="@(item.id)">@($"{item.code}-{item.name}") </SelectItem>
                    }
                </Select>
            }
        </div>
        <div class="col-md-3">
            <Label>Fecha Inicial:</Label>
            <input type="date" class="form-control" @bind="@_fechaini" />
        </div>
        <div class="col-md-3">
            <Label>Fecha Final:</Label>
            <input type="date" class="form-control" @bind="@_fechafin" />
        </div>
        <div class="col-md-2">
            <Button Color="Color.Success" Clicked="@procesar" class="btn-continuar btn-block margen-sup30">Consultar</Button>
        </div>

    </div>
    <div class="row margen-sup">
        <MensajeInPopUp Mensaje="@_Mensaje" clase="@_mensajeIsDanger"></MensajeInPopUp>

        <DataGrid TItem="SaldoProducto_data" Data="_lista" ShowPager="true" Filterable="true" FilterMethod="DataGridFilterMethod.Contains"
                  PageSize="5" EditMode="DataGridEditMode.Popup" RowStyling="@estilofila" SelectedRowStyling="@filaSeleccionada"
                  Bordered="true" Striped="true" Responsive="true" Hoverable="true" >

            <ChildContent>
                <DataGridCommandColumn TItem="SaldoProducto_data">
                    <ClearFilterCommandTemplate> <span @onclick="@context.Clicked">Limpiar Filtro</span> </ClearFilterCommandTemplate>
                </DataGridCommandColumn>

                <DataGridColumn TItem="SaldoProducto_data" Field="@nameof(SaldoProducto_data.id)" Caption="Id" Sortable="false" Editable="false" Displayable="false"/>

                <DataGridNumericColumn TItem="SaldoProducto_data" Field="@nameof(SaldoProducto_data.initialbalance)" Caption="Anterior" Editable="true" Width="100">
                    <DisplayTemplate>  @($"{( context as SaldoProducto_data)?.initialbalance} Ptos") </DisplayTemplate>
                </DataGridNumericColumn>
                <DataGridNumericColumn TItem="SaldoProducto_data" Field="@nameof(SaldoProducto_data.inputquantity)" Caption="Entrada" Editable="true" Width="100">
                    <DisplayTemplate>  @($"{( context as SaldoProducto_data)?.inputquantity} Ptos") </DisplayTemplate>
                </DataGridNumericColumn>
                <DataGridNumericColumn TItem="SaldoProducto_data" Field="@nameof(SaldoProducto_data.outputquantity)" Caption="Salida" Editable="true" Width="100">
                    <DisplayTemplate>  @($"{( context as SaldoProducto_data)?.outputquantity} Ptos") </DisplayTemplate>
                </DataGridNumericColumn>
                <DataGridNumericColumn TItem="SaldoProducto_data" Field="@nameof(SaldoProducto_data.balancequantity)" Caption="Saldo" Editable="false" Width="100">
                    <DisplayTemplate>  @($"{( context as SaldoProducto_data)?.balancequantity} Ptos") </DisplayTemplate>
                </DataGridNumericColumn>


                <DataGridNumericColumn TItem="SaldoProducto_data" Field="@nameof(SaldoProducto_data.active)" Caption="Activo" Editable="false" Width="50">
                    <DisplayTemplate>
                        <Check @bind-Checked="@context.active" TValue="Boolean" Disabled="true"></Check>
                    </DisplayTemplate>
                </DataGridNumericColumn>

            </ChildContent>

            <FirstPageButtonTemplate> <span>Prim</span> </FirstPageButtonTemplate>
            <PreviousPageButtonTemplate> <span>Ant</span> </PreviousPageButtonTemplate>
            <NextPageButtonTemplate> <span>Sig</span> </NextPageButtonTemplate>
            <LastPageButtonTemplate> <span>Ult</span> </LastPageButtonTemplate>
            <PopupTitleTemplate>
                <TituloComponent _titulo=@((context.EditState== DataGridEditState.New ? "Insertando" : "Actualizando")+ " Registro")></TituloComponent>
            </PopupTitleTemplate>

            <EmptyTemplate><div class="box"> No hay información...!!</div> </EmptyTemplate>

            <LoadingTemplate> <div class="box"><progress class="progress is-small is-primary" max="100" /></div></LoadingTemplate>

        </DataGrid>

    </div>
</div>

